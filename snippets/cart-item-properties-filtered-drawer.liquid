{%- comment -%}
  Cart Item Properties Filtered (Drawer)
  Displays cart item properties with filtering for cart drawer (uses dl/dt/dd structure)

  SOLID Principles:
  - Single Responsibility: Solely responsible for filtering and displaying properties in drawer format
  - Open/Closed: Extend by modifying this snippet, not cart drawer template

  Usage:
  {%- render 'cart-item-properties-filtered-drawer', item: item -%}

  If cart-drawer.liquid is overwritten, replace property display blocks with this snippet.
{%- endcomment -%}

{%- for property in item.properties -%}
  {%- assign property_first_char = property.first | slice: 0 -%}
  {%- assign property_value = property.last | append: '' | strip -%}

  {%- comment -%} Skip if empty or internal property {%- endcomment -%}
  {%- if property.last == blank or property_first_char == '_' -%}
    {%- continue -%}
  {%- endif -%}

  {%- comment -%} Check if value is an "empty default" zero (has decimal precision, indicating form default) {%- endcomment -%}
  {%- assign num_value = property_value | plus: 0 -%}
  {%- assign is_empty_default_zero = false -%}
  {%- if num_value == 0 -%}
    {%- comment -%} Only filter zeros with decimal precision (0.0, 0.00, etc.) - these are form defaults {%- endcomment -%}
    {%- comment -%} Keep integer "0" as potentially valid value {%- endcomment -%}
    {%- if property_value contains '.' -%}
      {%- comment -%} Check if it's a zero with trailing zeros (form default pattern) {%- endcomment -%}
      {%- assign zero_patterns = '0.0,0.00,0.000,0.0000' | split: ',' -%}
      {%- if zero_patterns contains property_value -%}
        {%- assign is_empty_default_zero = true -%}
      {%- endif -%}
    {%- endif -%}
  {%- endif -%}

  {%- comment -%} Display property if not empty default zero {%- endcomment -%}
  {%- if is_empty_default_zero == false -%}
    <div class="product-option">
      <dt>{{ property.first }}:</dt>
      <dd>
        {%- if property.last contains '/uploads/' -%}
          <a
            href="{{ property.last }}"
            class="link"
            target="_blank"
            aria-describedby="a11y-new-window-message"
          >
            {{ property.last | split: '/' | last }}
          </a>
        {%- else -%}
          {{ property.last }}
        {%- endif -%}
      </dd>
    </div>
  {%- endif -%}
{%- endfor -%}

