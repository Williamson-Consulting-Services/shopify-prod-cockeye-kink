{% comment %}
  Measurement Field Group Component
  Renders all measurement fields based on measurement names, organized into groups
  Parameters:
    - measurement_names: Array of measurement names
    - section_id: The section ID for form association
{% endcomment %}

<div class="other-category-notice" id="other-category-notice" style="display: none;">
  <div class="notice-banner">
    <span class="notice-icon">ℹ️</span>
    <span class="notice-text">{{ 'custom_measurements.other_category_notice' | t }}</span>
  </div>
</div>

{%- assign default_upper_body = 'Head Circumference,Neck,Shoulders,Chest,Sleeve Length,Bicep,Wrist,Palm Circumference,Hand Length' -%}
{%- assign default_torso_hips = 'Torso,Stomach,Waist,Hips' -%}
{%- assign default_lower_body = 'Upper Thigh,Lower Thigh,Knee,Calf,Ankle,Inseam,Crotch,Butt Rise,Length' -%}

{%- assign upper_body_source = settings.custom_measurements_group_upper_body | default: default_upper_body -%}
{%- assign torso_hips_source = settings.custom_measurements_group_torso_hips | default: default_torso_hips -%}
{%- assign lower_body_source = settings.custom_measurements_group_lower_body | default: default_lower_body -%}

{%- assign upper_body_measurements = upper_body_source | split: ',' -%}
{%- assign torso_hips_measurements = torso_hips_source | split: ',' -%}
{%- assign lower_body_measurements = lower_body_source | split: ',' -%}

{%- assign all_grouped_measurements = upper_body_measurements
  | concat: torso_hips_measurements
  | concat: lower_body_measurements
-%}

{%- render 'custom-measurements-group',
  group_measurements: upper_body_measurements,
  group_label: 'custom_measurements.group_upper_body',
  group_id: 'upper-body',
  container_id: 'measurementsGroup-upper',
  measurement_names: measurement_names,
  section_id: section_id
-%}

{%- render 'custom-measurements-group',
  group_measurements: torso_hips_measurements,
  group_label: 'custom_measurements.group_torso_hips',
  group_id: 'torso-hips',
  container_id: 'measurementsGroup-torso',
  measurement_names: measurement_names,
  section_id: section_id
-%}

{%- render 'custom-measurements-group',
  group_measurements: lower_body_measurements,
  group_label: 'custom_measurements.group_lower_body',
  group_id: 'lower-body',
  container_id: 'measurementsGroup-lower',
  measurement_names: measurement_names,
  section_id: section_id
-%}
<div class="measurement-group" data-group="other" id="measurementsGroup-other" style="display: none;">
  <div class="measurements-group">
    {%- for meas_name in measurement_names -%}
      {%- assign measurement_label = meas_name | strip | remove: '*' | strip -%}
      {%- if measurement_label == '' -%}{% continue %}{% endif %}
      {%- assign is_in_any_group = false -%}
      {%- for group_meas in all_grouped_measurements -%}
        {%- assign group_meas_stripped = group_meas | strip | remove: '*' | strip -%}
        {%- if measurement_label == group_meas_stripped -%}
          {%- assign is_in_any_group = true -%}
          {%- break -%}
        {%- endif -%}
      {%- endfor -%}
      {%- unless is_in_any_group -%}
        {%- render 'custom-measurements-field', measurement_label: measurement_label, section_id: section_id -%}
      {%- endunless -%}
    {%- endfor -%}
  </div>
</div>
