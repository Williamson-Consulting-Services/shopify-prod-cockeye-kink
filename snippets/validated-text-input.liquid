<div style="margin-bottom:15px;">
  <label for="custom-engraving">Engraving (5 chars max, A-Z, 0-9):</label>
  
  <input 
    type="text" 
    id="custom-engraving" 
    name="properties[Engraving]"
    maxlength="5"
    pattern="[a-zA-Z0-9]*"
    title="Only letters (A-Z) and numbers (0-9) are allowed."
    style="width: 100%; border: 1px solid #ccc; padding: 8px;">
  
  <div id="engraving-error" style="color: red; display: none; margin-top: 5px; font-size: 0.9em;">
    Please use only 5 characters (letters and numbers).
  </div>
</div>

<script>
  (function() {
    // Find the product form for this specific section
    // This makes it safe to use on the same page multiple times
    const currentScript = document.currentScript;
    const section = currentScript.closest('.shopify-section');
    
    if (!section) return;

    const productForm = section.querySelector('form[action$="/cart/add"]');
    const customInput = section.querySelector('#custom-engraving');
    const errorMsg = section.querySelector('#engraving-error');

    if (productForm && customInput) {
      productForm.addEventListener('submit', function(event) {
        if (!customInput.checkValidity()) {
          event.preventDefault(); // Stop the 'Add to Cart'
          errorMsg.style.display = 'block'; // Show error
        } else {
          errorMsg.style.display = 'none'; // Hide error
        }
      });
      
      // Bonus: Clear error when user starts typing again
      customInput.addEventListener('input', function() {
        if (customInput.checkValidity()) {
          errorMsg.style.display = 'none';
        }
      });
    }
  })();
</script>